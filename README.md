# Mapping environmental injustices within the U.S. prison system

This is the working repository for a NASA ROSES-21 A.49 Earth Science Applications: Equity and Environmental Justice funded project (Award No 80NSSC22K1465) titled "Leveraging Earth science data to heighten awareness of environmental injustices within the U.S. prison system".

This repository hosts the workflow used to carry out the spatial analysis, from data retrieval to producing the final dataset that is hosted (here). Below are further details on the repository structure, how to use the code base, and data sources.

Forward any questions reguarding this project and code base to Caitlin Mothes ([ccmothes\@colostate.edu](mailto:ccmothes@colostate.edu){.email})

<br/>

## Folder Descriptions

-   `doc/` Project-specific references and metadata. Also includes the NASA-funded project proposal that includes background, objectives and methods of the project.

-   `data/` This folder is stored locally (see Github_Collab_Guide.docx in `doc/` for methods on how to set up a local data folder that syncs to a cloud-hosted folder). All raw, unprocessed data lives in `raw/` and all datasets processed throughout the workflow (using code in `process_data/`) go to `processed/` . GEE-processed datasets also live in this `processed/` folder.

-   `process_data/` Scripts to process raw data (when needed). Outputs of these scripts go into `data/processed/`

-   `R/` R code for analysis, each formatted as an individual function for each indicator calculation (i.e., all indicators not requiring Earth Engine data sets).

-   `python/` Python code for Google Earth Engine analyses. Specifically used to calculate canopy cover and land surface temperature variables.

-   `jobs/` Job scripts to run background jobs for each component function (See 'process_components.Rmd' for executing these.

-   `outputs/` Where all outputs from each indicator function, component function and final data frame calculation are stored. Each file is set up to include the date of creation when saved to this folder.

-   `analysis/` R code for all post-hoc analysis of final data set.

-   `figures/` Figures produced from analysis scripts.

-   `working_scripts/` Old or in progress scripts outside of current workflow. External collaborators can disregard this folder.

## File Descriptions

There are a few important files in the root directory:

-   `setup.R` Executing this script will install and load all necessary packages, source all functions, and create a local 'outputs/' directory if it does not already exist.

-   `process_indicators.R / .Rmd` This file (saved as both an R script and R Markdown for user preference) works through executing indicator calculations individually.

-   `process_components.Rmd` This file walks the user through calculating indicators as grouped component scores. It also has an option for executing the component functions as background jobs (as some may take days to full execute due to large datasets and scale of processing).

## General workflow

The main files described above give users the option to run individual indicators or process the entire component scores all at once, and each work through creating a final data frame as the last step.

This workflow is designed to work on ANY spatial polygon `sf` object. While this project specifically studies state and federal US prisons, the code can be applied to any other boundary shapefile, greatly expanding the utility of this code base and allowing for future researchers to analyze other areas of interest (e.g., extend to jails and juvenile detention centers, or calculate measures for other communities/neighborhoods to assess comparisons with risks faces by prisoners).

While some functions and scripts retrieve the datasets directly from the code base, some need to be downloaded manually. The table below provides links to download each of the datasets used in this project, and direct users to the processing script used to clean the raw data download (if necessary).

## Data sources and indicator methods

+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Indicator                               | Dataset used                                                                                                                                                                                                                      | Function / file name         | Processing script (if applicable) | Indicator Description                                                                                                                                             | Time frame / last updated | Spatial resolution (if raster) |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Heat index                              | [MODIS daily land surface temperature](https://developers.google.com/earth-engine/datasets/catalog/MODIS_061_MYD11A1#description)                                                                                                 | python/calc_myd11_lst_day.py | procces_data/process_lst.R        | Mean daily LST for summer months (June-August) from the last 10 years (2012-2022) averaged within prison boundaries.                                              | 2012 - 2022               | 1 km                           |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Canopy cover                            | [USGS National Land Cover Database](https://developers.google.com/earth-engine/datasets/catalog/USGS_NLCD_RELEASES_2016_REL)                                                                                                      | python/calc_canopy_cover.py  |                                   | Average percent canopy cover within prison boundaries + 1km buffer.                                                                                               | 2016                      | 30 m                           |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Wildfire risk                           | [Wildfire Hazard Potential for the United States](https://www.fs.usda.gov/rds/archive/catalog/RDS-2015-0047-3)                                                                                                                    | calc_wildfire_risk.R         |                                   | Mean wildfire hazard potential within prison boundary + 1km buffer                                                                                                | 2020                      | 270 m                          |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Flood risk                              | [FEMA National Flood Hazard Layer](https://www.fema.gov/flood-maps/national-flood-hazard-layer)                                                                                                                                   | calc_flood_risk.R            |                                   | Percentage of each prison boundary + 1km buffer that is covered by a high risk flood zone (Zones A and Z; at least a one percent chance of flooding annually)     | August 2021               |                                |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Ozone                                   | [SEDAC Annual O3 Concentrations for CONUS](https://sedac.ciesin.columbia.edu/data/set/aqdh-o3-concentrations-contiguous-us-1-km-2000-2016)                                                                                        | calc_ozone.R                 |                                   | Average annual ozone levels for 2015 and 2016 within prison boundaries + 1km buffer                                                                               | 2015-2016                 | 1 km                           |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| PM 2.5                                  | [SEDAC Annual PM2.5 Concentrations for CONUS](https://sedac.ciesin.columbia.edu/data/set/aqdh-pm2-5-concentrations-contiguous-us-1-km-2000-2016)                                                                                  | calc_pm25.R                  |                                   | Average annual PM2.5 levels for 2015 and 2016 within prison boundaries + 1km buffer                                                                               | 2015-2016                 | 1 km                           |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Traffic volume and proximity            | [FHA's Annual Average Daily Traffic](https://www.fhwa.dot.gov/policyinformation/hpms/shapefiles.cfm)                                                                                                                              | calc_traffic_proximity.R     | process_data/process_traffic.R    | Count of vehicles (AADT, avg. annual daily traffic) at major roads within 500 meters, divided by distance in meters                                               | 2018                      |                                |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Pesticide use                           | [SEDAC Global Pesticide Grids](https://sedac.ciesin.columbia.edu/data/set/ferman-v1-pest-chemgrids-v1-01)                                                                                                                         | calc_pesticides.R            |                                   | The total pesticide application from 2015 in kg/ha\*yr averaged over prison boundaries + 1km buffer.                                                              | 2015                      | \~ 10 km (5 arc-minute)        |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Superfund/NPL proximity                 | [EPA](https://cumulis.epa.gov/supercpad/CurSites/srchsites.cfm) (click 'View a list of all NPL and SAA sites' then 'Download Excel file')                                                                                         | calc_npl_proximity.R         | process_data/process_npl.R        | Count of proposed and listed NPL facilities within 5km (or nearest one beyond 5km) each divided by the distance in km                                             | October 2022              |                                |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Risk Management Plan facility proximity | [HIFLD EPA ER Risk Management Plan Facilities](https://hifld-geoplatform.opendata.arcgis.com/datasets/geoplatform::epa-emergency-response-er-risk-management-plan-rmp-facilities/explore?location=29.842034%2C-113.806709%2C3.92) | calc_rmp_proximity.R         |                                   | Count of Risk Management Plan (potential chemical accident management plan) facilities within 5km (or nearest one beyond 5km) each divided by the distance in km. | May 2023                  |                                |
|                                         |                                                                                                                                                                                                                                   |                              |                                   |                                                                                                                                                                   |                           |                                |
|                                         |                                                                                                                                                                                                                                   |                              |                                   | Modeled after EJ Screen methods (pg. 21): <https://www.epa.gov/sites/default/files/2021-04/documents/ejscreen_technical_document.pdf>                             |                           |                                |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
| Hazardous waste facility proximity      | [EPA FRS geospatial download](https://www.epa.gov/frs/geospatial-data-download-service) (Downloaded the National and State ALL FRS single CSV file)                                                                               | calc_haz_waste_proximity.R   | process_data/process_haz_waste/R  | Count of hazardous waste facilities within 5km of prison boundary (or nearest beyond 5km) each divided by distance in km                                          | March 2023                |                                |
+-----------------------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------+-----------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+--------------------------------+
